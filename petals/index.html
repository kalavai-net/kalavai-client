
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../public_pool/">
      
      
        <link rel="next" href="../templates/">
      
      
      <link rel="icon" href="../assets/icons/browser.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.33">
    
    
      
        <title>Petals swarm - Kalavai Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#public-petals-swarm-bittorrent-style-llms" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Kalavai Documentation" class="md-header__button md-logo" aria-label="Kalavai Documentation" data-md-component="logo">
      
  <img src="../assets/icons/logo_no_background.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kalavai Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Petals swarm
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Kalavai Documentation" class="md-nav__button md-logo" aria-label="Kalavai Documentation" data-md-component="logo">
      
  <img src="../assets/icons/logo_no_background.png" alt="logo">

    </a>
    Kalavai Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to Kalavai
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Create AI pools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Create AI pools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../local_pool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Local pools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../public_pool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Public pools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Community computing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Community computing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Petals swarm
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Petals swarm
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-join" class="md-nav__link">
    <span class="md-ellipsis">
      How to join
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-petals-health" class="md-nav__link">
    <span class="md-ellipsis">
      Check Petals health
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-the-models" class="md-nav__link">
    <span class="md-ellipsis">
      How to use the models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stop-sharing" class="md-nav__link">
    <span class="md-ellipsis">
      Stop sharing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faqs" class="md-nav__link">
    <span class="md-ellipsis">
      FAQs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FAQs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-i-join-and-leave-whenever-i-want" class="md-nav__link">
    <span class="md-ellipsis">
      Can I join (and leave) whenever I want?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-in-it-for-me" class="md-nav__link">
    <span class="md-ellipsis">
      What is in it for me?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is-my-data-secured-private" class="md-nav__link">
    <span class="md-ellipsis">
      Is my data secured / private?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is-my-gpu-constantly-being-used" class="md-nav__link">
    <span class="md-ellipsis">
      Is my GPU constantly being used?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Applications
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../templates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Templates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ray/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ray
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      Requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-join" class="md-nav__link">
    <span class="md-ellipsis">
      How to join
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#check-petals-health" class="md-nav__link">
    <span class="md-ellipsis">
      Check Petals health
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-use-the-models" class="md-nav__link">
    <span class="md-ellipsis">
      How to use the models
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stop-sharing" class="md-nav__link">
    <span class="md-ellipsis">
      Stop sharing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faqs" class="md-nav__link">
    <span class="md-ellipsis">
      FAQs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FAQs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-i-join-and-leave-whenever-i-want" class="md-nav__link">
    <span class="md-ellipsis">
      Can I join (and leave) whenever I want?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-in-it-for-me" class="md-nav__link">
    <span class="md-ellipsis">
      What is in it for me?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is-my-data-secured-private" class="md-nav__link">
    <span class="md-ellipsis">
      Is my data secured / private?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#is-my-gpu-constantly-being-used" class="md-nav__link">
    <span class="md-ellipsis">
      Is my GPU constantly being used?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">petals</span>
    
  
    
    
    
      <span class="md-tag">share</span>
    
  
</nav>



<h1 id="public-petals-swarm-bittorrent-style-llms">Public Petals Swarm: BitTorrent-style LLMs</h1>
<p>Contribute to the public Petals swarm and help deploy and fine tune Large Language Models across consumer-grade devices. See more about the Petals projecyt <a href="https://github.com/bigscience-workshop/petals">here</a>. You'll get:
- Eternal kudos from the community!
- Access to all the models in the server
- Easy access for inference (via Petals SDK and installation-free Kalavai endpoint).</p>
<h2 id="requirements">Requirements</h2>
<ul>
<li>A free Kalavai account. Create one <a href="https://platform.kalavai.net">here</a>.</li>
<li>A computer with the minimum requirements (see below)</li>
</ul>
<p>Hardware requirements
- 1+ NVIDIA GPU
- 2+ CPUs
- 4GB+ RAM
- Free space 4x available VRAM (for an 8GB VRAM GPU, you'll need ~32GB free space in your disk)</p>
<h2 id="how-to-join">How to join</h2>
<ol>
<li>
<p>Create a <a href="https://platform.kalavai.net">free account</a> with Kalavai.</p>
</li>
<li>
<p>Install the kalavai client following the instructions <a href="https://kalavai-net.github.io/kalavai-client/getting_started/">here</a>. Currently we support Linux distros and Windows.</p>
</li>
<li>
<p>Get the joining token. Visit our <a href="https://platform.kalavai.net">platform</a> and go to <code>Compute pools</code>. Then click <code>Join</code> on the <code>Petals</code> Pool to reveal the joining details. Copy the command (including the token).</p>
</li>
</ol>
<p><img alt="Join Petals" src="/docs/docs/assets/images/join.png" /></p>
<ol>
<li>From the computer you want to share work with, run the joining command:</li>
</ol>
<pre><code class="language-bash">$ kalavai pool join &lt;token&gt;

[16:28:14] Token format is correct
           Joining private network

[16:28:24] Scanning for valid IPs...
           Using 100.10.0.8 address for worker
           Connecting to PETALS @ 100.10.0.9 (this may take a few minutes)...
[16:29:41] Worskpace created
           You are connected to PETALS
</code></pre>
<h2 id="check-petals-health">Check Petals health</h2>
<p>Kalavai's pool connects directly to the public swarm on Petals, which means we can use their <a href="https://health.petals.dev/">public health check UI</a> to see how much we are contributing and what models are ready to use.</p>
<p><img alt="alt text" src="/docs/docs/assets/images/petals_health.png" /></p>
<p>Models with at least one copy of each shard (a green dot in each column) are ready to be used. If not, wait for more workers to join in.</p>
<h2 id="how-to-use-the-models">How to use the models</h2>
<p>For all public swarms you can use the Petals SDK in the <a href="https://github.com/bigscience-workshop/petals">usual way</a>. Here is an example:</p>
<pre><code class="language-python">from transformers import AutoTokenizer
from petals import AutoDistributedModelForCausalLM

# Choose any model available at https://health.petals.dev
model_name = &quot;mistralai/Mixtral-8x22B-Instruct-v0.1&quot;

# Connect to a distributed network hosting model layers
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoDistributedModelForCausalLM.from_pretrained(model_name)

# Run the model as if it were on your computer
inputs = tokenizer(&quot;A cat sat&quot;, return_tensors=&quot;pt&quot;)[&quot;input_ids&quot;]
outputs = model.generate(inputs, max_new_tokens=5)
print(tokenizer.decode(outputs[0]))  # A cat sat on a mat...
</code></pre>
<p>This path is great if you are a dev with python installed, and don't mind installing the Petals SDK. If you want an install-free path, Kalavai deploys a single endpoint for models, which allows you to do inference via gRPC and HTTP requests. Here is a request example:</p>
<pre><code class="language-python">&quot;&quot;&quot;
More info: https://github.com/petals-infra/chat.petals.dev

Required: pip install websockets
&quot;&quot;&quot;
import time
import json
import websockets
import asyncio


URL = &quot;192.168.68.67:31220&quot; # &lt;-- change for the kalavai endpoint
MODEL_NAME = &quot;mistralai/Mixtral-8x22B-Instruct-v0.1&quot; # &lt;-- change for the models available in Kalavai PETALS pool.


async def ws_generate(text, max_length=100, temperature=0.1):
    async with websockets.connect(f&quot;ws://{URL}/api/v2/generate&quot;) as websocket:
        try:
            await websocket.send(
                json.dumps({&quot;model&quot;: MODEL_NAME, &quot;type&quot;: &quot;open_inference_session&quot;, &quot;max_length&quot;: max_length})
            )
            response = await websocket.recv()
            result = json.loads(response)

            if result[&quot;ok&quot;]:
                await websocket.send(
                    json.dumps({
                        &quot;type&quot;: &quot;generate&quot;,
                        &quot;model&quot;: MODEL_NAME,
                        &quot;inputs&quot;: text,
                        &quot;max_length&quot;: max_length,
                        &quot;temperature&quot;: temperature
                    })
                )
                response = await websocket.recv()
                return json.loads(response)
            else:
                return response
        except Exception as e:
            return {&quot;error&quot;: str(e)}


if __name__ == &quot;__main__&quot;:
    t = time.time()
    output = asyncio.get_event_loop().run_until_complete(
        ws_generate(text=&quot;Tell me a story: &quot;)
    )
    final_time = time.time() - t
    print(f&quot;[{final_time:.2f} secs]&quot;, output)
    print(f&quot;{output['token_count'] / final_time:.2f}&quot;, &quot;tokens/s&quot;)
</code></pre>
<p><strong>NOTE</strong>: the endpoints are only available within worker nodes, not from any other computer.</p>
<h2 id="stop-sharing">Stop sharing</h2>
<p>You can either pause sharing, or stop and leave the pool altogether (don't worry, you can rejoin using the same steps above anytime). </p>
<p>To pause sharing (but remain on the pool), run the following command:</p>
<pre><code class="language-bash">kalavai pool pause
</code></pre>
<p>When you are ready to resume sharing, run:</p>
<pre><code class="language-bash">kalavai pool resume
</code></pre>
<p>To stop and leave the pool, run the following:</p>
<pre><code class="language-bash">kalavai pool stop
</code></pre>
<h2 id="faqs">FAQs</h2>
<h3 id="can-i-join-and-leave-whenever-i-want">Can I join (and leave) whenever I want?</h3>
<p>Yes, you can, and we won't hold a grudge if you need to use your computer. You can pause or quit altogether as indicated <a href="#stop-sharing">here</a>.</p>
<h3 id="what-is-in-it-for-me">What is in it for me?</h3>
<p>If you decide to share your compute with the community, not only you'll get access to all the models we deploy in it, but you will also gather credits in Kalavai, which will be redeemable for computing in any other public pool (this feature is coming really soon).</p>
<h3 id="is-my-data-secured-private">Is my data secured / private?</h3>
<p>The public pool in Kalavai has the same level of privacy and security than the general Petals public swarm. See their privacy details <a href="https://github.com/bigscience-workshop/petals/wiki/Security,-privacy,-and-AI-safety">here</a>. In the future we will improve support for private swarms; at the moment private swarms are a beta feature for all kalavai pools that can be used via the <a href="/templates/petals/README.md">petals template</a>.</p>
<h3 id="is-my-gpu-constantly-being-used">Is my GPU constantly being used?</h3>
<p>Yes and no. The model weights for the shard you are responsible for are loaded in GPU memory for as long as your machine is sharing. However, this does not mean the GPU is active (doing computing) constantly; computation (and hence the vast majority of energy comsumption) only happens when your shard is summoned to process inference requests.</p>
<p>If at any point you need your GPU memory back, <a href="#stop-sharing">pause or stop sharing</a> and come back when you are free.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.instant", "navigation.instant.progress"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.af256bd8.min.js"></script>
      
    
  </body>
</html>